<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="fragments :: head">
</head>
<body>
<header th:include="fragments :: header" class="fixed-top">
</header>

<div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-light">
    <div class="col-md-20 p-lg-1 mx-auto my-1">
        <h1 class="display-4 font-weight-normal">Wszystkie obecne zlecenia serwisowe</h1>
        <br>
        <form th:action="@{/list}" method="get">
            <input type="text" placeholder="Producent" th:value="${filters.producer}" name="producer">
            <input type="text" placeholder="Model" th:value="${filters.model}" name="model">
            <input type="text" placeholder="Numer Rejestracyjny" th:value="${filters.registrationNumber}"
                   name="registrationNumber">
            <input type="text" placeholder="Sortowanie" th:value="${sortOption}" name="sort" hidden>
            <input type="submit" value="Filtruj" class="btn btn-primary"/>
        </form>
        <br>
        <table class="table">
            <thead>
            <tr>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=id'}">
                        Numer
                    </a>
                </th>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=producer'}">
                        Producent
                    </a>
                </th>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=model'}">
                        Model
                    </a>
                </th>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=registrationNumber'}">
                        Numer rejestracyjny
                    </a>
                </th>
                <th>
                    Numer VIN
                </th>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=engineCapacity'}">
                        Pojemność silnika
                    </a>
                </th>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=fuelType'}">
                        Rodzaj paliwa
                    </a>
                </th>
                <th>
                    <a th:href="@{'/list?page=' + ${currentPage} + '&sort=deadlineDate'}">
                        Termin zakończenia
                    </a>
                </th>
                <th>
                    Osoba kontaktowa
                </th>
                <th>
                    Zadania
                </th>
                <th>
                    Akcje
                </th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="order: ${orderList}">
                <td th:text="${order.id}"></td>
                <td th:text="${order.producer}"></td>
                <td th:text="${order.model}"></td>
                <td th:text="${order.registrationNumber}"></td>
                <td th:text="${order.vinNumber}"></td>
                <td th:text="|${order.engineCapacity} cm³|"></td>
                <td th:text="${order.fuelType.description}"></td>
                <td th:text="${order.getDateTimeInSqlDateTimeFormat(order.deadlineDate)}"></td>
                <td th:text="|${order.contactPerson.firstName} ${order.contactPerson.lastName}|"></td>
                <td>
                    <small th:text="${order.countAllTasks()}"></small><br>
                    <small th:text="${order.countNewTasks()}"></small><br>
                    <small th:text="${order.countInPogressTasks()}"></small><br>
                </td>
                <td>
                    <small>
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-pen" fill="currentColor"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd"
                                  d="M5.707 13.707a1 1 0 0 1-.39.242l-3 1a1 1 0 0 1-1.266-1.265l1-3a1 1 0 0 1 .242-.391L10.086 2.5a2 2 0 0 1 2.828 0l.586.586a2 2 0 0 1 0 2.828l-7.793 7.793zM3 11l7.793-7.793a1 1 0 0 1 1.414 0l.586.586a1 1 0 0 1 0 1.414L5 13l-3 1 1-3z"/>
                            <path fill-rule="evenodd"
                                  d="M9.854 2.56a.5.5 0 0 0-.708 0L5.854 5.855a.5.5 0 0 1-.708-.708L8.44 1.854a1.5 1.5 0 0 1 2.122 0l.293.292a.5.5 0 0 1-.707.708l-.293-.293z"/>
                            <path d="M13.293 1.207a1 1 0 0 1 1.414 0l.03.03a1 1 0 0 1 .03 1.383L13.5 4 12 2.5l1.293-1.293z"/>
                        </svg>
                        <a th:href="@{'/updateServiceOrder?id=' + ${order.id}}" class="category-item">Edytuj</a>
                        <br>
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash" fill="currentColor"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                            <path fill-rule="evenodd"
                                  d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                        </svg>
                        <a th:href="@{'/removeServiceOrder?id=' + ${order.id}}" class="category-item">Usuń</a>
                        <br>
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-file-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M4 1h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H4z"/>
                            <path fill-rule="evenodd" d="M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z"/>
                        </svg>
                        <a th:href="@{'/addNewTaskToServiceOrder?id=' + ${order.id}}" class="category-item">Zadanie</a>
                    </small>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <p th:if="${orderList.size()} == 0" th:text="'Brak wyników!'" style="color: darkgrey"></p>
    <div class="row" th:fragment="pagination">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <nav aria-label="Pagination">
                <ul class="pagination justify-content-center">
                    <li class="page-item" th:each="pageNumber : ${pageNumbers}">
                        <a class="page-link" th:href="@{/list(page=${pageNumber},
                                                                    sort=${sortOption},
                                                                    producer=${filters.producer},
                                                                    registrationNumber=${filters.registrationNumber},
                                                                    model=${filters.model})}"
                           th:text=${pageNumber}>1</a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="col-md-2"></div>
    </div>
</div>


<footer th:include="fragments :: footer-links" class="container py-5">
</footer>
<footer th:include="fragments :: footer-fixed" class="black-transparent mt-auto py-1 fixed-bottom">
</footer>
<div th:include="fragments :: scripts">
</div>
</body>
</html>
